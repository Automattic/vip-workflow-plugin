(()=>{"use strict";var e={8053:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(5573),o=r(4848);const n=(0,o.jsx)(s.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,o.jsx)(s.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})})},4764:(e,t,r)=>{r.d(t,{M_:()=>s.M});var s=r(9406)},7805:(e,t,r)=>{r.r(t),r.d(t,{closeModal:()=>v,disableComplementaryArea:()=>l,enableComplementaryArea:()=>c,openModal:()=>f,pinItem:()=>u,setDefaultComplementaryArea:()=>i,setFeatureDefaults:()=>_,setFeatureValue:()=>m,toggleFeature:()=>p,unpinItem:()=>d});var s=r(4040),o=r.n(s),n=r(1233),a=r(9561);const i=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=(0,a.F)(e),area:t=(0,a.M)(e,t)}),c=(e,t)=>({registry:r,dispatch:s})=>{t&&(e=(0,a.F)(e),t=(0,a.M)(e,t),r.select(n.store).get(e,"isComplementaryAreaVisible")||r.dispatch(n.store).set(e,"isComplementaryAreaVisible",!0),s({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},l=e=>({registry:t})=>{e=(0,a.F)(e),t.select(n.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(n.store).set(e,"isComplementaryAreaVisible",!1)},u=(e,t)=>({registry:r})=>{if(!t)return;e=(0,a.F)(e),t=(0,a.M)(e,t);const s=r.select(n.store).get(e,"pinnedItems");!0!==s?.[t]&&r.dispatch(n.store).set(e,"pinnedItems",{...s,[t]:!0})},d=(e,t)=>({registry:r})=>{if(!t)return;e=(0,a.F)(e),t=(0,a.M)(e,t);const s=r.select(n.store).get(e,"pinnedItems");r.dispatch(n.store).set(e,"pinnedItems",{...s,[t]:!1})};function p(e,t){return function({registry:r}){o()("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),r.dispatch(n.store).toggle(e,t)}}function m(e,t,r){return function({registry:s}){o()("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),s.dispatch(n.store).set(e,t,!!r)}}function _(e,t){return function({registry:r}){o()("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),r.dispatch(n.store).setDefaults(e,t)}}function f(e){return{type:"OPEN_MODAL",name:e}}function v(){return{type:"CLOSE_MODAL"}}},8991:(e,t,r)=>{r.d(t,{E:()=>s});const s="core/interface"},9561:(e,t,r)=>{r.d(t,{F:()=>n,M:()=>a});var s=r(4040),o=r.n(s);function n(e){return["core/edit-post","core/edit-site"].includes(e)?(o()(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function a(e,t){return"core"===e&&"edit-site/template"===t?(o()("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(o()("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}},9406:(e,t,r)=>{r.d(t,{M:()=>c});var s=r(7143),o=r(7805),n=r(532),a=r(4962),i=r(8991);const c=(0,s.createReduxStore)(i.E,{reducer:a.Ay,actions:o,selectors:n});(0,s.register)(c)},4962:(e,t,r)=>{r.d(t,{Ay:()=>s});const s=(0,r(7143).combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:r,area:s}=t;return e[r]?e:{...e,[r]:s}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:r,area:s}=t;return{...e,[r]:s}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}})},532:(e,t,r)=>{r.r(t),r.d(t,{getActiveComplementaryArea:()=>c,isComplementaryAreaLoading:()=>l,isFeatureActive:()=>d,isItemPinned:()=>u,isModalActive:()=>p});var s=r(7143),o=r(4040),n=r.n(o),a=r(1233),i=r(9561);const c=(0,s.createRegistrySelector)((e=>(t,r)=>{r=(0,i.F)(r);const s=e(a.store).get(r,"isComplementaryAreaVisible");if(void 0!==s)return!1===s?null:t?.complementaryAreas?.[r]})),l=(0,s.createRegistrySelector)((e=>(t,r)=>{r=(0,i.F)(r);const s=e(a.store).get(r,"isComplementaryAreaVisible"),o=t?.complementaryAreas?.[r];return s&&void 0===o})),u=(0,s.createRegistrySelector)((e=>(t,r,s)=>{var o;r=(0,i.F)(r),s=(0,i.M)(r,s);const n=e(a.store).get(r,"pinnedItems");return null===(o=n?.[s])||void 0===o||o})),d=(0,s.createRegistrySelector)((e=>(t,r,s)=>(n()("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(a.store).get(r,s))));function p(e,t){return e.activeModal===t}},3393:(e,t,r)=>{r.d(t,{A:()=>f});var s=r(1609),o=r(6427),n=r(7143),a=r(4309),i=r(3656),c=r(6087),l=r(7723),u=r(8053),d=r(7527);const p=VW_CUSTOM_STATUSES.status_terms.map((e=>({label:e.name,value:e.slug})));(0,n.subscribe)((function(){if((0,n.select)(i.store).getCurrentPostId()&&((0,n.select)(i.store).isCleanNewPost()&&(0,n.dispatch)(i.store).editPost({status:p[0].value}),VW_CUSTOM_STATUSES.is_publish_guard_enabled)){const e=document.querySelectorAll("#vip-workflow-editorial-metadata-label");if(!e||0===e.length)return;const t=VW_CUSTOM_STATUSES.status_terms.find((e=>e.slug===(0,n.select)(i.store).getCurrentPostAttribute("status")));if(!t)return;e.forEach((e=>{e?.classList&&(t?.meta?.required_metadatas&&t?.meta?.required_metadatas.length>0&&t?.meta?.required_metadatas.some((t=>e.classList.contains(t.slug)))?e.classList.add("vip-workflow-editorial-metadata-required"):e.classList.remove("vip-workflow-editorial-metadata-required"))}))}}));const m=({label:e,onToggle:t,shouldTruncate:r})=>(0,s.createElement)(o.__experimentalHStack,{__nextHasNoMarginBottom:!0},(0,s.createElement)("label",{title:(0,l.__)("View the current status, or rollback to a previous status","vip-workflow")},(0,l.__)("Extended Post Status","vip-workflow")),(0,s.createElement)(o.Button,{style:{whiteSpace:"normal"},size:"compact",variant:"tertiary",onClick:t},r?(0,s.createElement)(o.__experimentalTruncate,{limit:15,ellipsizeMode:"tail"},e):e)),_=({popoverAnchor:e,text:t})=>(0,c.useMemo)((()=>({anchor:e,"aria-label":t,placement:"left-start",offset:36,shift:!0})),[e]);function f({onUpdateStatus:e,postType:t,status:r}){const[f,v]=(0,c.useState)(null),S=_({popoverAnchor:f,text:(0,l.__)("Select Status")}),g=t=>{e(t),(0,n.dispatch)(i.store).savePost()};if(!(0,d.C)(t,r))return null;const w=p.findIndex((e=>e.value===r)),y=p.slice(0,w+1),A=VW_CUSTOM_STATUSES.status_terms.find((e=>e.slug===r))?.name;return(0,s.createElement)(a.PluginPostStatusInfo,{__nextHasNoMarginBottom:!0,className:`vip-workflow-extended-post-status vip-workflow-extended-post-status-${r}`},(0,s.createElement)(o.Dropdown,{__nextHasNoMarginBottom:!0,ref:v,popoverProps:S,focusOnMount:!0,renderToggle:({onToggle:e})=>m({label:A,onToggle:e,shouldTruncate:!0}),renderContent:({onClose:e})=>(0,s.createElement)(o.Flex,{direction:["column"],justify:"start",align:"centre",className:"vip-workflow-text-popover"},(0,s.createElement)(o.Flex,{direction:["row"],justify:"start",align:"end"},(0,s.createElement)(o.__experimentalHeading,{level:2,size:13},(0,l.__)("Extended Post Status","vip-workflow")),(0,s.createElement)(o.Flex,{direction:["row"],justify:"end",align:"end"},(0,s.createElement)(o.Button,{label:(0,l.__)("Close"),icon:u.A,onClick:e}))),(0,s.createElement)(o.RadioControl,{selected:r,options:y,onChange:g}))}))}},406:(e,t,r)=>{r.d(t,{A:()=>a});var s=r(7143),o=r(6087);const n={};function a(e,t,r){n?.[e]?.[t]||(n?.[e]||(n[e]={}),n[e][t]={actionIntercept:null,callback:r}),(0,o.useEffect)((()=>{n[e][t].callback=r}),[e,t,r]),(0,s.use)((r=>({dispatch:s=>{const o="string"==typeof s?s:s.name,a={...r.dispatch(o)};if(o!==e)return a;if(!n[e][t].actionIntercept){const r=a[t];n[e][t].actionIntercept=(...s)=>{n[e][t].callback(r,s)}}return a[t]=n[e][t].actionIntercept,a}})))}},1987:(e,t,r)=>{r.d(t,{A:()=>a});var s=r(7143),o=r(4764),n=r(406);function a(e,t){const r=()=>(0,s.select)(o.M_).getActiveComplementaryArea("core")===e;(0,n.A)(o.M_.name,"enableComplementaryArea",((s,o)=>{if("core"===o?.[0]&&o?.[1]===e){const e=r();t(e,(()=>s(...o)))}else s(...o)})),(0,n.A)(o.M_.name,"disableComplementaryArea",((e,s)=>{const o=r();o?t(o,(()=>e(...s))):e(...s)}))}},7527:(e,t,r)=>{function s(e,t){const r=VW_CUSTOM_STATUSES.supported_post_types.includes(e),s=VW_CUSTOM_STATUSES.status_terms.map((e=>e.slug)).includes(t);return r&&s}r.d(t,{C:()=>s})},1020:(e,t,r)=>{var s=r(1609),o=Symbol.for("react.element"),n=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,r){var s,c={},l=null,u=null;for(s in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)n.call(t,s)&&!i.hasOwnProperty(s)&&(c[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===c[s]&&(c[s]=t[s]);return{$$typeof:o,type:e,key:l,ref:u,props:c,_owner:a.current}}},4848:(e,t,r)=>{e.exports=r(1020)},1609:e=>{e.exports=window.React},6427:e=>{e.exports=window.wp.components},9491:e=>{e.exports=window.wp.compose},7143:e=>{e.exports=window.wp.data},4040:e=>{e.exports=window.wp.deprecated},4309:e=>{e.exports=window.wp.editPost},3656:e=>{e.exports=window.wp.editor},6087:e=>{e.exports=window.wp.element},7723:e=>{e.exports=window.wp.i18n},2279:e=>{e.exports=window.wp.plugins},1233:e=>{e.exports=window.wp.preferences},5573:e=>{e.exports=window.wp.primitives},4164:(e,t,r)=>{function s(e){var t,r,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=s(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}r.d(t,{A:()=>o});const o=function(){for(var e,t,r=0,o="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=s(e))&&(o&&(o+=" "),o+=t);return o}}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=r(1609),t=r(9491),s=r(7143),o=r(4309),n=r(3656),a=r(6087),i=r(7723),c=r(2279),l=r(4164),u=r(3393),d=r(1987);const p="vip-workflow-custom-status",m="vip-workflow-sidebar";(0,c.registerPlugin)(p,{render:(0,t.compose)((0,s.withSelect)((e=>{const{getEditedPostAttribute:t,getCurrentPostAttribute:r,isSavingPost:s,getCurrentPost:o,getCurrentPostType:a}=e(n.store),i=o(),c="auto-draft"===i?.status;return{savedStatus:r("status"),editedStatus:t("status"),metaFields:t("meta"),postType:a(),isSavingPost:s(),isUnsavedPost:c}})),(0,s.withDispatch)((e=>({onUpdateStatus(t){e(n.store).editPost({status:t},{undoIgnore:!0})}}))))((({postType:r,savedStatus:c,editedStatus:l,metaFields:y,isUnsavedPost:A,isSavingPost:T,onUpdateStatus:E})=>{const b=(0,t.useViewportMatch)("small","<"),M=(0,t.useViewportMatch)("wide",">="),h=(0,a.useMemo)((()=>{const e=g(c);return S(e,y)}),[c,y]),C=(0,a.useMemo)((()=>f(A,r,c,h)),[A,r,c,h]);(0,e.useEffect)((()=>{if(VW_CUSTOM_STATUSES.is_publish_guard_enabled){const e=document.querySelector("#editor");if(!e)return;C?e.classList.add("disable-native-save-button"):e.classList.remove("disable-native-save-button")}}),[C]);const x=(0,a.useMemo)((()=>w(c)),[c]),P=T||h;(0,d.A)(`${p}/${m}`,((e,t)=>{P||x&&(E(x.slug),(0,s.dispatch)(n.store).savePost())}));const O=v(x,h,M),U=h?(0,i.__)("Requirements for advancing have not been met.","vip-workflow"):O,k=(0,e.createElement)(_,{buttonText:O,isSavingPost:T,isDisabled:P,isTinyViewport:b});return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(u.A,{postType:r,status:l,onUpdateStatus:E}),C&&(0,e.createElement)(o.PluginSidebar,{name:m,title:U,icon:k},null))}))});const _=({buttonText:t,isSavingPost:r,isDisabled:s,isTinyViewport:o})=>{const n=(0,l.A)("vip-workflow-save-button",{"is-busy":r,"is-disabled":s,"is-tiny":o});return(0,e.createElement)("div",{className:n},t)},f=(e,t,r,s)=>{if(e)return!1;const o=VW_CUSTOM_STATUSES.supported_post_types.includes(t),n=VW_CUSTOM_STATUSES.status_terms.slice(0,-1).map((e=>e.slug)).includes(r);return o&&(n||s)},v=(e,t,r)=>{let s=(0,i.__)("Save","vip-workflow");if(e){const t=e.name;if(r)
// translators: %s: Next custom status name, e.g. "Draft"
s=(0,i.sprintf)((0,i.__)("Move to %s","vip-workflow"),t);else{const e=y(t,7);
// translators: %s: Next custom status name, possibly truncated with an ellipsis. e.g. "Draft" or "Pendi…"
s=(0,i.sprintf)((0,i.__)("Move to %s","vip-workflow"),e)}}else!e&&t&&(s=(0,i.__)("Publish","vip-workflow"));return s},S=(e,t)=>{let r=!1;if(e?.meta?.required_user_ids&&e.meta.required_user_ids.length>0){const t=e.meta.required_user_ids,s=parseInt(VW_CUSTOM_STATUSES.current_user_id,10);r=!t.includes(s)}return!r&&e?.meta?.required_metadatas&&e.meta.required_metadatas.length>0&&(r=e.meta.required_metadatas.some((e=>{const r=e.meta.postmeta_key;return"checkbox"===e.meta.type?!t[r]:!t[r]||0===t[r].length}))),r},g=e=>VW_CUSTOM_STATUSES.status_terms.find((t=>t.slug===e))||!1,w=e=>{const t=VW_CUSTOM_STATUSES.status_terms.findIndex((t=>t.slug===e));return-1!==t&&t!==VW_CUSTOM_STATUSES.status_terms.length-1&&VW_CUSTOM_STATUSES.status_terms[t+1]},y=(e,t)=>e.length>t?e.slice(0,t)+"…":e})()})();
//# sourceMappingURL=custom-status-block.js.map