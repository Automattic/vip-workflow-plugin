(()=>{"use strict";var e={1609:e=>{e.exports=window.React},1455:e=>{e.exports=window.wp.apiFetch},4715:e=>{e.exports=window.wp.blockEditor},6427:e=>{e.exports=window.wp.components},7143:e=>{e.exports=window.wp.data},4309:e=>{e.exports=window.wp.editPost},6087:e=>{e.exports=window.wp.element},7723:e=>{e.exports=window.wp.i18n},2279:e=>{e.exports=window.wp.plugins}},r={};function t(o){var n=r[o];if(void 0!==n)return n.exports;var l=r[o]={exports:{}};return e[o](l,l.exports,t),l.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var o in r)t.o(r,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e=t(1609),r=t(1455),o=t.n(r),n=t(4715),l=t(6427),i=t(7143),a=t(4309),s=t(6087),c=t(7723),p=t(2279);const w=({onUrl:r})=>{const[t,n]=(0,s.useState)(!1);return(0,e.createElement)(e.Fragment,null,t&&(0,e.createElement)(l.Spinner,null),!t&&(0,e.createElement)(l.Button,{className:"vip-workflow-secure-preview-button",variant:"secondary",onClick:async()=>{let e={};try{n(!0),e=await o()({url:VW_SECURE_PREVIEW.url_generate_preview,method:"POST"})}catch(e){const r=VW_SECURE_PREVIEW.text_preview_error+" "+e.message;(0,i.dispatch)("core/notices").createErrorNotice(r,{id:"vw-secure-preview",isDismissible:!0})}finally{n(!1)}e?.url&&r(e.url)}},(0,c.__)("Generate Link","vip-workflow")))},u=({url:r})=>{const t=(0,s.useRef)(null),o={anchorRef:t,placement:"left-start",offset:36,shift:!0},i="/"+r.split("/").pop();return(0,e.createElement)("div",{ref:t},(0,e.createElement)(l.Dropdown,{popoverProps:o,focusOnMount:!0,renderToggle:({onToggle:r})=>(0,e.createElement)(l.Button,{size:"compact",variant:"tertiary",onClick:r},(0,e.createElement)(l.__experimentalTruncate,{limit:15,ellipsizeMode:"tail"},i)),renderContent:({onClose:t})=>(0,e.createElement)("div",{className:"vip-workflow-secure-link-dropdown-content"},(0,e.createElement)(n.__experimentalInspectorPopoverHeader,{title:(0,c.__)("Secure Preview Link"),onClose:t}),(0,e.createElement)(l.ExternalLink,{className:"editor-post-url__link",href:r,target:"_blank"},r))}))};(0,p.registerPlugin)("vip-workflow-secure-preview",{icon:"vip-workflow",render:()=>{const[r,t]=(0,s.useState)(null);return(0,e.createElement)(a.PluginPostStatusInfo,{className:"vip-workflow-secure-preview"},(0,e.createElement)("div",{className:"vip-workflow-secure-preview-row"},(0,e.createElement)("div",{className:"vip-workflow-secure-preview-label"},(0,c.__)("Secure Preview","vip-workflow")),!r&&(0,e.createElement)(w,{onUrl:e=>t(e)}),r&&(0,e.createElement)(u,{url:r})))}})})()})();
//# sourceMappingURL=secure-preview.js.map